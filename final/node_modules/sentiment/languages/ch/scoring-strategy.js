var negators = require('./negators.json');
var double = require('./double.json');

module.exports = {
    // 当前词为积极 前一词为否定：-1   前一词为程度：+2  其他：+1

    // 当前词为消极 前一词为否定：+1   前一词为程度：-2  其他：-1

    /**
     * 
     * @param {*} tokens 分词后列表
     * @param {*} cursor 当前词索引
     * @param {*} tokenScore 当前词对应权重
     */
    apply: function(tokens, cursor, tokenScore) {
        if (cursor > 0) {
            var prevtoken = tokens[cursor - 1];
            if (negators[prevtoken] === -1) {
                // 前一词否定
                tokenScore = -tokenScore;
            } else if(negators[prevtoken] === 1){
                // 前一次程度词
                tokenScore *= tokenScore;
            }
        }
        return tokenScore;
    },

    //判断当前词应该取+取-    当前总体>0 取+   当前总体<0 取-
    /**
     * 
     * @param {*} curScore 目前整体情感趋向
     * @param {*} tokens 分词后列表
     * @param {*} cursor 当前词索引
     * @param {*} tokenScore 当前词对应权重
     */
    distinguish: function(curScore, curWord, tokenMood) {
        if(double[curWord]) {
            if(curScore >= 0) {
                tokenMood.side = double[curWord].good.side;
                tokenMood.mood = double[curWord].good.mood;
            } else if(curScore < 0) {
                tokenMood.side = double[curWord].bad.side;
                tokenMood.mood = double[curWord].bad.mood;
            }
        }
        return tokenMood;
    }
};
